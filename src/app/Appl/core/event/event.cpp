/***********************************************************************************************************************
 * event.cpp                                                                                                           *
 ***********************************************************************************************************************
 * DESCRIPTION :                                                                                                       *
 *       APIs for controlling application events (i.e. timer, filesystem, socket connection etc.)                      *
 * PUBLIC FUNCTIONS :                                                                                                  *
 *       ev_t*               event_alloc(void)                                                                         *
 *                                                                                                                     *
 * AUTHOR :                                                                                                            *
 *       Yahor Yauseyenka    email: yahoryauseyenka@gmail.com                                                          *
 *                                                                                                                     *
 * VERSION                                                                                                             *
 *       0.0.2               last modification: 20-04-2024                                                             *
 *                                                                                                                     *
 * LICENSE                                                                                                             *
 *       GPL                                                                                                           *
 *                                                                                                                     *
 **********************************************************************************************************************/

/***********************************************************************************************************************
 *  INCLUDES
 **********************************************************************************************************************/
#include <stdlib.h>

#include "event.h"
#include "utils.h"
#include "hab_device_types.h"

/***********************************************************************************************************************
 *  PREPROCESSOR DEFINITIONS
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * LOCAL TYPEDEFS DECLARATION
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * GLOBAL VARIABLES DECLARATION
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * LOCAL FUNCTION DEFINITION
 **********************************************************************************************************************/

/***********************************************************************************************************************
 * GLOBAL FUNCTION DEFINITION
 **********************************************************************************************************************/
ev_t *event_alloc(void) {
    ev_t *event = NULL;
    uv_handle_t *handle = NULL;

    event = (ev_t *)malloc(sizeof(ev_t));
    if (NULL == event) {
        fprintf(stderr, "ERROR: Error when allocating event.\n");
        return NULL;
    }

    handle = (uv_handle_t *)malloc(sizeof(uv_handle_t) + sizeof(habdev_t));
    if (NULL == handle) {
        fprintf(stderr, "ERROR: Error when allocating event handle.\n");
        return NULL;
    }

    event->handle = handle;

    return event;
}

/***********************************************************************************************************************
 * END OF FILE
 **********************************************************************************************************************/
